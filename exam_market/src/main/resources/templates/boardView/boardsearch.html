<!DOCTYPE html>
<html xmlns:th="http://thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
<meta charset="UTF-8">
<title>Board insert</title>
<script>
	$(document).ready(function() {
		$("#keyword").keyup(function () {
			search();
		});
	});
	
	function search() {
		var keyword = $("#keyword").val();
		var category = $("select[name='category']").val();
		
		$.ajax({
			type: 'POST',
			url: "boardsearch",
			data: {
				item: keyword,
				category: category,
			},
			dataType: 'json',
			success: function (list) {
				updateSearchResults(data);
			},
			error: function (error) {
				console.error("검색중 오류 발생: ",error);
			}	
		});
	}
	
	function updateSearchResults(data) {
		$.ajax({
			url: 'search',
			type:'POST',
			dataType: 'json',
			data: {item: keyword, category: category},
			success: function(ilst) {
				let str = '<table>';
				$(list).each(function (i, item){
					str += '<tr>';
					str += '<td>' + item.boardnum + '<td>';
					str += '<td>' + item.category + '<td>';
					str += '<td>' + item.title + '<td>';
					str += '</tr>';					
				});
				str += '</table>';
				$('#listDiv').html(str);
			}
		});
	}
	
</script>
</head>
<body>
<header>
	<h1>[ 판매 상품 검색 ]</h1>
</header>
<section>
	<div> <!--선택박스-->
		<form th:action="@{/board/boardsearch}" method="post">
			<select name="category">
				<option value="all" selected>전체</option>
				<option value="computer">컴퓨터 및 주변기기</option>
				<option value="camera">카메라</option>
				<option value="car">자동차용품</option>
			</select>
			<!--검색 input-->
			<input type="text" id="keyword" name="item">
		</form>
		<table>
			<tr>
				<td>번호</td>
				<td>카테고리</td>
				<td>제목</td>
			</tr>
		</table> <br>
		<div id="listDiv"></div>
	</div>
</section>
</body>
</html>